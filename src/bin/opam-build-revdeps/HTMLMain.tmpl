<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="generator" content="{{ generator }}" />
    <title>Comparison of {{ run1.name }} and {{ run2.name }}</title>
    <script>

function displayFullResult(id) {
  [].forEach.call(document.getElementsByClassName("container"), function(d) {
    d.style.display = 'none';
  });
  document.getElementById(id).style.display = 'block';
  document.getElementById(id + ":package").style.display = 'block';
  document.getElementById(id + ":actions").style.display = 'inline-block';
}

function hideFullResult() {
  [].forEach.call(document.getElementsByClassName("container"), function(d) {
    d.style.removeProperty('display');
  });
  [].forEach.call(document.getElementsByClassName("package"), function(d) {
    d.style.removeProperty('display');
  });
  [].forEach.call(document.getElementsByClassName("actions"), function(d) {
    d.style.removeProperty('display');
  });
}

function updateState() {
  let hash = window.location.hash;
  if (hash == '' || hash == '#') {
    hideFullResult();
  } else {
    displayFullResult(hash.substring(1));
  }
}

document.addEventListener("DOMContentLoaded", function(event) {
  updateState();
});
    </script>
    <style type="text/css">
div.container {
  display: inline-block;
  padding: 0;
  margin: 0;
}

div.summary {
  width: 150px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  display: inline-block;
  padding: 0;
  margin: 0;
  vertical-align: top;
}

div.summary.ok {
  background: lightgreen;
}

div.summary.ko, div.summary.rootpackageko, div.summary.missing {
  background: lightpink;
}

div.summary.asbad {
  background: lightcyan;
}

div.summary.dependsko {
  background: lightyellow;
}

div.package, div.actions {
  display: none;
}

div.actions.div {
  display: inline-block;
  vertical-align: top;
}

p.time, p.logs, pre.logs {
  margin: 0;
}

p.count, p#is_better {
  margin: 0;
}

p#count_missing {
  margin-bottom: 16px;
}

div.pkg1, div.pkg2 {
  display: inline-block;
  width: 49%;
  margin: 0;
  padding: 0;
  vertical-align: top;
  overflow: hidden;
  text-overflow: ellipsis;
}

div.pkg2 {
  border-left: 3px black solid;
  padding-left: 10px;
}
    </style>
  </head>
  <body onhashchange="updateState()">
  <h1>Building reverse-dependencies of {{ run1.name }} and
    {{ run2.name }}</h1>
  <p id="is_better"><strong>Is Better: {{ is_better }}</strong> </p>
  <p class="count" id="total_packages">Total packages: {{ total_packages }}</p>
  <p class="count" id="count_ok">Packages in state "OK": {{ count_ok }}</p>
  <p class="count" id="count_ko">Packages in state "KO": {{ count_ko }}</p>
  <p class="count" id="count_dependsko">
    Packages in state "DependsKO": {{ count_dependsko }}
  </p>
  <p class="count" id="count_rootpackageko">
    Packages in state "RootPackageKO": {{ count_rootpackageko }}
  </p>
  <p class="count" id="count_asbad">
    Packages in state "AsBad": {{ count_asbad }}
  </p>
  <p class="count" id="count_missing">
    Packages in state "Missing": {{ count_missing }}
  </p>
{%- for pkg in packages -%}
  <div id="{{ pkg.name }}" class="container">
    <div class="actions" id="{{ pkg.name }}:actions">
      <a href="#">&#8592;</a>
    </div>
    <div class="summary {{ pkg.status }}">
      {%- if pkg.status == "ok" %}&#x2713;{% endif -%}
      {%- if pkg.status == "ko" %}&#x2715;{% endif -%}
      {%- if pkg.status == "rootpackageko" %}&#x2715;{% endif -%}
      {%- if pkg.status == "dependsko" %}~{% endif -%}
      {%- if pkg.status == "missing" %}~{% endif -%}
      {%- if pkg.status == "asbad" %}={% endif -%}
      &nbsp;<a href="#{{ pkg.name }}">{{ pkg.name }}</a></div>
    <div class="package" id="{{ pkg.name }}:package">
      <p>Result with {{ run1.name }}: {{ pkg.pkg1.result }}</p>
      <p>Result with {{ run2.name }}: {{ pkg.pkg2.result }}</p>
      <h2>Building dependencies of {{ pkg.name }}</h2>
      {{ result(pkg.pkg1.deps, "pkg1 depends", run1.name) }}
      {{ result(pkg.pkg2.deps, "pkg2 depends", run2.name) }}
      <h2>Building {{ pkg.name }} with {{ run2.name }}</h2>
      {{ result(pkg.pkg1.build, "pkg1 build", run1.name) }}
      {{ result(pkg.pkg2.build, "pkg2 build", run2.name) }}
    </div>
  </div>
{%- endfor -%}
<p><a href="{{ generator_url }}">Generated with {{ generator }}</a></p>
  </body>
</html>
{%- macro result(i, class, root_package) -%}
        <div class="{{ class }}">
          <h3>With {{ root_package }}</h3>
          <p class="time">Time to build: {{ i.time }}</p>
          <p class="logs">Logs:
          <pre class="logs">
{{ i.logs }}
          </pre>
        </div>
{%- endmacro -%}
