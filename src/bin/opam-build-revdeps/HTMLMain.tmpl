<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <script>
function displayFullResult(id) {
  [].forEach.call(document.getElementsByClassName("container"), function(d) {
    d.style.display = 'none';
  });
  document.getElementById(id).style.display = 'block';
  document.getElementById(id + ":package").style.display = 'block';
  document.getElementById(id + ":actions").style.display = 'inline-block';
  window.location.hash = id;
}

function hideFullResult(id) {
  [].forEach.call(document.getElementsByClassName("container"), function(d) {
    d.style.removeProperty('display');
  });
  document.getElementById(id + ":package").style.removeProperty('display');
  document.getElementById(id + ":actions").style.removeProperty('display');
  window.location.hash = '';
}

document.addEventListener("DOMContentLoaded", function(event) {
  let hash = window.location.hash;
  if (hash != '' && hash != '#') {
    console.log("window.location.hash: " + hash.substring(1));
    displayFullResult(hash.substring(1));
  }
});
    </script>
    <style type="text/css">
div.container {
  display: inline-block;
  padding: 0;
  margin: 0;
}

div.summary {
  width: 150px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  display: inline-block;
  padding: 0;
  margin: 0;
  vertical-align: top;
}

div.summary.ok {
  background: lightgreen;
}

div.summary.ko, div.summary.rootpackageko, div.summary.missing {
  background: lightpink;
}

div.summary.asbad {
  background: lightcyan;
}

div.summary.dependsko {
  background: lightyellow;
}

div.package, div.actions {
  display: none;
}

div.actions.div {
  display: inline-block;
  vertical-align: top;
}

p.time, p.logs, pre.logs {
  margin: 0;
}

p.count, p#is_better {
  margin: 0;
}

p#count_missing {
  margin-bottom: 16px;
}
    </style>
  </head>
  <body>
  <h1>Building reverse-dependencies of {{ run1.name }} and
    {{ run2.name }}</h1>
  <p id="is_better"><strong>Is Better: {{ is_better }}</strong> </p>
  <p class="count" id="total_packages">Total packages: {{ total_packages }}</p>
  <p class="count" id="count_ok">Packages in state "OK": {{ count_ok }}</p>
  <p class="count" id="count_ko">Packages in state "KO": {{ count_ko }}</p>
  <p class="count" id="count_dependsko">
    Packages in state "DependsKO": {{ count_dependsko }}
  </p>
  <p class="count" id="count_rootpackageko">
    Packages in state "RootPackageKO": {{ count_rootpackageko }}
  </p>
  <p class="count" id="count_asbad">
    Packages in state "AsBad": {{ count_asbad }}
  </p>
  <p class="count" id="count_missing">
    Packages in state "Missing": {{ count_missing }}
  </p>
{% for pkg in packages %}
  <div id="{{ pkg.name }}" class="container">
    <div class="actions" id="{{ pkg.name }}:actions">
      <div onclick="hideFullResult('{{ pkg.name }}')">&#8592;</div>
    </div>
    <div class="summary {{ pkg.status }}"
         onclick="displayFullResult('{{ pkg.name }}')">
      {%- if pkg.status == "ok" %}&#x2713;{% endif -%}
      {%- if pkg.status == "ko" %}&#x2715;{% endif -%}
      {%- if pkg.status == "rootpackageko" %}&#x2715;{% endif -%}
      {%- if pkg.status == "dependsko" %}~{% endif -%}
      {%- if pkg.status == "missing" %}~{% endif -%}
      {%- if pkg.status == "asbad" %}={% endif -%}
      &nbsp;{{ pkg.name }}</div>
    <div class="package" id="{{ pkg.name }}:package">
      <h2>Building {{ pkg.name }} with {{ run1.name }}</h2>
      <div class="pkg1">
        {{ result(pkg.pkg1) }}
      </div>
      <h2>Building {{ pkg.name }} with {{ run2.name }}</h2>
      <div class="pkg2">
        {{ result(pkg.pkg2) }}
      </div>
    </div>
  </div>
{%- endfor -%}
  </body>
</html>
{% macro result(i) %}
  <h3>Building dependencies only for {{ item.name }}</h3>
  <div class="depends">
    <p class="time">Time to build: {{ i.deps.time }}</p>
    <p class="logs">Logs:
    <pre class="logs">
{{ i.deps.logs }}
    </pre>
  </div>
  <h3>Building {{ item.name }}</h3>
  <div class="build">
    <p class="time">Time to build: {{ i.build.time }}</p>
    <p class="logs">Logs:
    <pre class="logs">
{{ i.build.logs }}
    </pre>
  </div>
{% endmacro %}
